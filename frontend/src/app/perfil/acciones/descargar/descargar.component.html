<!-- Backdrop -->
<div *ngIf="open" class="fixed inset-0 z-[120] flex items-center justify-center" (click)="doClose()">
  <div class="absolute inset-0 bg-black/30"></div>

  <!-- Card -->
  <div
    class="relative bg-white rounded-xl shadow-xl w-[340px] max-w-[92vw] border border-blue-300"
    (click)="$event.stopPropagation()"
  >
    <!-- header -->
    <div class="flex items-center justify-between px-4 py-2 border-b border-blue-200">
      <h3 class="text-sm font-semibold text-gray-800">Preparando la descarga</h3>
      <button class="text-gray-500 hover:text-gray-700" (click)="doClose()" aria-label="Cerrar">✕</button>
    </div>

    <!-- body -->
    <div class="px-4 py-3 space-y-3">
      <!-- Estado 1 -->
      <div *ngIf="step==='preparando'" class="text-gray-700">
        Preparando la descarga…
      </div>

      <!-- Estado 2 -->
      <div *ngIf="step==='comprimiendo'" class="flex items-center justify-between text-gray-700">
        <span>Comprimiendo {{ count }} archivo<span *ngIf="count!==1">s</span></span>
        <span class="inline-block animate-spin select-none">⏳</span>
      </div>

      <!-- Estado 3 -->
      <div *ngIf="step==='listo'" class="flex items-center justify-between text-green-600 font-medium">
        <span>{{ count }} archivo<span *ngIf="count!==1">s</span> comprimido<span *ngIf="count!==1">s</span></span>
        <span class="select-none">✔️</span>
      </div>
    </div>
  </div>
</div>
